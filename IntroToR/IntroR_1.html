<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>Introduction to R</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<p><strong>Navigation - <a href="../README.html">Home</a> - <a href="../BasicSearches/BasicSearches.html">Basic Search</a></strong></p>

<h1>Introduction to R</h1>

<h3>Palynological Databases: Hands-on Computer Workshop, AASP 46th Meeting, San Francisco</h3>

<p>This lab is designed to give you a gentle introduction to R. It will cover basic functionality of R, including variables and functions, together with some examples using descriptive statistics and plotting. If you have not already used R, it is recommended that you work through the first two sections of this document before starting to work with the RNeotoma package.</p>

<p>We will be using a file of pollen data for this lab: <em>percSite.csv</em></p>

<h2>Data in R</h2>

<p>One of the main ways in which R differs from spreadsheet software is that it uses a <em>workspace</em> in the memory of your computer, and the data you use and create is stored there as a <em>variable</em>: an <em>object</em> with a <em>name</em> and a <em>value</em>. This first section will introduce the different types of variable and how to manipulate them.</p>

<h3>Variables in R</h3>

<p>The basic form of a variable in R comes in two parts, the variable name (e.g. x) and the value that
is attributed to it (e.g. 5). The assignment operators (<code>=</code> and <code>&lt;-</code>) are used to associate a given value with a variable. For example <code>x &lt;- 5</code> gives the value 5 to a variable called <code>x</code> and creates it if it does not exist. Once a variable is created, the value is not fixed and may be modified at anytime, and also may be used in subsequent operations. Note that as you create variables, nothing will appear on the screen. To see the value(s) assigned to any variable, simply type its name at the prompt. Try entering the following commands at the command prompt:</p>

<pre><code class="r">x &lt;- 5
x
sqrt(x)
x &lt;- 9
x
sqrt(9)
</code></pre>

<h3>Data modes in R</h3>

<p>R can deal with many different types or modes of data, but some of the most common are:</p>

<ul>
<li>Numeric, e.g. 5 or 6e-5<br/></li>
<li>Character  e.g. &#39;San Francisco&#39; or &#39;London&#39;</li>
<li>Factor e.g. &#39;male&#39; or &#39;female&#39;</li>
<li>Logic True/False</li>
</ul>

<h3>Data structures in R</h3>

<p>In addition to the data types, R has many standard structures (or objects) for storing data. These include:</p>

<ul>
<li>Single variables (0D): e.g. the population of Australia</li>
<li>Vectors (1D, 1 mode): e.g. the population size of each of the 20 largest cities of the world</li>
<li>Matrices (2D, 1 mode): a gridded climate field, a raster image</li>
<li>Arrays (nD, 1 mode): a stack of raster images for different time periods</li>
<li>Data frames (2D, multiple modes): a population survey - where many different types may be recorded for the same observation</li>
<li>Lists: A collection of other data objects</li>
</ul>

<h2>Manipulating variables in R</h2>

<h3>Reading data from files</h3>

<p>R can use many different file types, but csv files are recommended as the easiest way to transfer between R and Excel. Start by changing your working directory to the directory holding the two files listed above. Then get a list of files as follows (note the use of the <code>pattern</code> parameter to get only certain files):</p>

<pre><code class="r">list.files(&quot;./&quot;, pattern = &quot;.csv&quot;)
</code></pre>

<pre><code>## [1] &quot;cities.csv&quot;   &quot;iris.csv&quot;     &quot;percSite.csv&quot; &quot;test.csv&quot;
</code></pre>

<p>Now read in a file</p>

<pre><code class="r">pollen &lt;- read.csv(&quot;percSite.csv&quot;)
</code></pre>

<p>And check to see the variable <code>pollen</code> that has been created in the R workspace (note that variable <code>x</code> we created earlier is also there).</p>

<pre><code class="r">ls()
</code></pre>

<pre><code>## [1] &quot;pollen&quot; &quot;x&quot;
</code></pre>

<p>R will store data read in a dataframe. To print out the contents of any variable, simply type the name of that variable at the command prompt. Other useful commands are <code>class()</code> to see what data class a variable is, and <code>names()</code> to get a list of the column headers. The function <code>str()</code> reports the structure of the data set, describing the column names and the type of data stored in them.</p>

<pre><code class="r">pollen
class(pollen)
names(pollen)
str(pollen)
</code></pre>

<p>In order to access the values in a dataframe or other R object, there are two main methods: column notation and indexing. Column notation uses the dollar sign ($) after the name of dataframe, with the column name appended (note that R replaces any white spaces in the column names with &#39;.&#39;). For example:</p>

<pre><code class="r">pollen$Betula
pollen$Pinus.subg..Strobus
</code></pre>

<p>Indexing uses a coordinate system to access variables. These are given in brackets after the name of the object, and take as many indexes as there are dimensions of the data object. So for a 1D vector, we require one, for a 2D matrix or data frame, we require two, etc. For matrices and data frames, the indices are [row,column]. If either of these are left blank, then all rows (or columns) are selected:</p>

<pre><code class="r">pollen[, 1:4]  # Columns 1 to 4
pollen[1:10, ]  # First 10 rows
pollen[1:20, 1:2]  # Indices can be combined
pollen$Betula[1:25]  # Note that indices can be combined
pollen$Betula[3]  # 3rd element
pollen$Betula[-3]  # All but 3rd element
</code></pre>

<p>Logical operators \( <, <=, >, >=, ==, != \) can be used to select parts of the data set by value. This is very useful if you only want to analyze part of your dataset, or split your dataset into groups:</p>

<pre><code class="r">pollen$Betula[pollen$agecal &lt; 5000]  # All Betula counts with an age &lt; 5ka BP
pollen$Betula[pollen$Pinus.subg..Strobus &gt; 70]  # All Betula counts when Pine &gt; 70%
</code></pre>

<h3>Writing data to files</h3>

<p>Variables created in R may also written out to csv files using the <code>write.csv()</code> function.</p>

<pre><code class="r">x &lt;- pollen$Betula[pollen$agecal &lt; 5000]
write.csv(x, &quot;test.csv&quot;)
</code></pre>

<p>This will write a csv file called <em>test.csv</em> in your working directory, containing the values in the vector <code>x</code>, created from the original data frame . Note that R uses the variable name as a column header and adds a column with line numbers. You can remove the line numbers by adding the parameter <code>row.names=FALSE</code> to the <code>write.csv()</code> function. </p>

<h3>R Workspace</h3>

<p>In general, R stores all the variables you have created in system memory. To see these variables at any time, type:</p>

<pre><code class="r">ls()
</code></pre>

<p>Alternatively, look in the &#39;Environment&#39; tab in the top-right hand window in RStudio.
The function <code>save.image()</code> allows you to save the contents of the workspace into
file called <em>.RData</em> in the current working directory.</p>

<pre><code class="r">save.image()
</code></pre>

<p>Variables can be removed using the <code>rm()</code> function.</p>

<pre><code class="r">rm(x)
rm(list = ls())
</code></pre>

<p>This last command removes all variables from the workspace. Of course, if you have
already saved them using the <code>save.image()</code>, you can restore the workspace
with <code>load(&quot;.RData&quot;)</code>. </p>

<pre><code class="r">load(&quot;.RData&quot;)
</code></pre>

<h2>Functions in R</h2>

<p>Functions typically are comprised of the name of the function (<code>sqrt()</code> for taking square roots) and a set of parentheses. The parentheses are used to pass data to the function as well as setting parameters to change the behavior of the function.</p>

<pre><code class="r">sqrt(5)
</code></pre>

<p>Note that we can use the assignment operator to save the output from a function, allowing you to use this in subsequent functions and analyses. </p>

<pre><code class="r">y = sqrt(5)
round(y)
</code></pre>

<p>To save time and code, functions can be combined:</p>

<pre><code class="r">round(sqrt(5))
</code></pre>

<p>The <code>seq()</code> function produces a series of numbers on a regular step. By default, it require 3 parameters, the starting number, the ending number and the step.</p>

<pre><code class="r">seq(from = 0, to = 20, by = 2)
</code></pre>

<p>If you include the parameter names, as in this example, the order does not matter. The parameter names can be omitted if you keep to the specified order of parameters. So this will give you the equivalent results.</p>

<pre><code class="r">seq(0, 20, 2)
</code></pre>

<p>To find out what these parameters are, what they are called and what values they take, use the <code>help()</code> function or the <code>?</code> operator, e.g.:</p>

<pre><code class="r">help(seq)
`?`(seq)
</code></pre>

<p>This will open a window with the help file for that function. If you do not know the name of a function, there is a search function <code>help.search()</code>, or use the help browser <code>help.start()</code>, browse to packages or use the search engine.</p>

<h2>Some basic statistical functions</h2>

<p>We will now create some new vectors in R containing Betula and Pine percentages and the age vector, in order to use these with functions. Note the use of the assignment operator <code>&lt;-</code>. You can also use the equal sign  (<code>=</code>) here and elsewhere in these examples.</p>

<pre><code class="r">bet &lt;- pollen$Betula
pin &lt;- pollen$Pinus.subg..Strobus
age &lt;- pollen$agebp
</code></pre>

<p>R has a large number of inbuilt functions. This section is designed to simply introduce you to the some basic functions for describing data.</p>

<h3>Functions to describe the central tendancy:</h3>

<pre><code class="r">mean(bet)
median(bet)
</code></pre>

<h3>Functions to describe the dispersion:</h3>

<pre><code class="r">sd(bet)
</code></pre>

<pre><code>## [1] 9.906
</code></pre>

<pre><code class="r">var(bet)
</code></pre>

<pre><code>## [1] 98.12
</code></pre>

<pre><code class="r">min(age)
</code></pre>

<pre><code>## [1] -26
</code></pre>

<pre><code class="r">max(age)
</code></pre>

<pre><code>## [1] 6485
</code></pre>

<pre><code class="r">range(age)
</code></pre>

<pre><code>## [1]  -26 6485
</code></pre>

<pre><code class="r">quantile(age)
</code></pre>

<pre><code>##   0%  25%  50%  75% 100% 
##  -26 1572 3717 5137 6485
</code></pre>

<p>Note that <code>quantile()</code> takes a parameter that allows you to choose the quantile to be calculated, e.g. <code>quantile(sl, c(0.1,0.9))</code>, will calculate the 10th and 90th percentile. I highly recommend that you read the help pages for these functions to understand what they do and how they can be modified. </p>

<h3>Some other useful functions:</h3>

<pre><code class="r">sum(bet)
summary(bet)
</code></pre>

<p>R is object oriented, and so many functions will adapt to different data types. For example, the summary() function will provide a different output for a vector and a data frame:</p>

<pre><code class="r">summary(bet)  ## Summary of numeric vector
summary(pollen)  ## Summary of data frame
</code></pre>

<h2>Bivariate statistics</h2>

<h3>Functions to assess the relationship between pairs of variables.</h3>

<p>Standard functions include calculation of the covariance and correlation:</p>

<pre><code class="r">cov(bet, pin)
cor(bet, pin)
</code></pre>

<p>The correlation function gives Pearson&#39;s coefficient by default. Look and try to identify strong positive and negative correlations (i.e. values closer to one). We can replace Pearson&#39;s method with a robust method, Spearmans rank correlation, by including the parameter <code>method</code>:</p>

<pre><code class="r">cor(bet, pin, method = &quot;spearman&quot;)
</code></pre>

<p>See the help for <code>cor()</code> for other parameters. The correlations obtained can be tested using the <code>cor.test()</code> function. Is there a significant correlation between Betula and Pine percentages? Is this to be expected?</p>

<pre><code class="r">cor.test(bet, pin, method = &quot;spearman&quot;)  # Significance?
</code></pre>

<pre><code>## Warning: Cannot compute exact p-value with ties
</code></pre>

<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  bet and pin
## S = 21795, p-value = 1.578e-15
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##     rho 
## -0.8986
</code></pre>

<p>The output gives you both the correlation coefficient (rho) and the <em>p</em>-value from a test against a <em>t</em>-distribution.</p>

<h2>Plot functions</h2>

<h4>Enumerative plots</h4>

<p>The simplest type of plot is an index plot, which simply plots values in the order they are recorded in the input vector. These are useful for examining the basic data structure and identifying errors and outliers. <code>plot()</code> is a generic plotting command and will adapt to different data types. The parameter <code>type=&#39;p&#39;</code> gives the plot type, here using points. Other options are <code>&#39;l&#39;</code> for lines, <code>&#39;h&#39;</code> for histogram lines, <code>&#39;s&#39;</code> for a stepped plot and <code>&#39;b&#39;</code> for both line and points. See <code>help(plot)</code> for more options and other parameters. </p>

<pre><code class="r">plot(bet, type = &quot;p&quot;)
</code></pre>

<h3>Summary plots</h3>

<p>Summary plots attempt to describe the distribution of the data, giving some ideas about which values are most common and which are most rare. Histograms are commonly used for this method, values are &#39;binned&#39; into a set of classes, and the histogram represents the frequency of occurrences in that bin. Bins are defined with the <code>breaks</code> parameter, which may be set to a constant number in which case the data range is split into that many bins, or as a sequence of numbers defining the intervals between bins. In this latter case, we can make use of the <code>seq()</code> function from earlier. </p>

<pre><code class="r">hist(bet, breaks = 20, main = &quot;Histogram of Betula percentages&quot;)
hist(bet, breaks = seq(0, 40, 1), main = &quot;Histogram of Betula percentages&quot;)
</code></pre>

<p>An alternative to histograms are boxplots, which show information about the data quartiles. Here the box represents the interquartile data (25-75% of the data), the thick bar is the median, and the &#39;whiskers&#39; show the data range.</p>

<pre><code class="r">boxplot(bet)
</code></pre>

<p>If we use the boxplot function with the full pollen data frame, it will produce boxplots for all taxa:</p>

<pre><code class="r">boxplot(pollen[, 5:73])
</code></pre>

<p>To make this a little more useful, we can take only a subset of pollen taxa, and plot them with a square-root transformation. This uses the indexing idea we covered earlier:</p>

<pre><code class="r">taxaID = c(5, 9, 24, 27, 31, 32, 34, 38, 47, 48)
names(pollen)[taxaID]
boxplot(sqrt(pollen[, taxaID]))
</code></pre>

<h3>Bivariate plots</h3>

<p>Bivariate plots are designed to show the relationship between two variables, and how this may vary. The simplest form is the scatter plot. We use the <code>plot()</code> function again, but now we give it two variables (x and y). We can use this to vosualize the relationship between Betula and Pine shown in the correlation analysis</p>

<pre><code class="r">plot(bet, pin)
</code></pre>

<p>Alternatively, we can plot pollen percentages against time (the third column of the data frame). Note the extra parameters to add better axis labels (<code>xlab</code>,<code>ylab</code>) and title (<code>main</code>).</p>

<pre><code class="r">plot(age, bet, type = &quot;l&quot;, xlab = &quot;Yrs BP&quot;, ylab = &quot;Percent&quot;, main = &quot;Betula pollen&quot;)
</code></pre>

<h2>Programming in R</h2>

<h3>Scripting</h3>

<p>As you do more in R, it is easier to use a script to record your commands, rather than entering them all at the command line. This is particularly true of commands that may span multiple lines as, if you make a mistake, it will be necessary to reenter each line. In both Windows and Mac OSX, R comes with an in-built scripting editor. Open a new script from the file menu, and type of copy the following commands to it:</p>

<pre><code class="r">irished &lt;- read.csv(&quot;irished.csv&quot;)
</code></pre>

<pre><code>## Warning: cannot open file &#39;irished.csv&#39;: No such file or directory
</code></pre>

<pre><code>## Error: cannot open the connection
</code></pre>

<pre><code class="r">irished$sex &lt;- factor(irished$sex, levels = c(1, 2), labels = c(&quot;male&quot;, &quot;female&quot;))
</code></pre>

<pre><code>## Error: object &#39;irished&#39; not found
</code></pre>

<pre><code class="r">hist(irished$DVRT, main = &quot;DVRT&quot;)
</code></pre>

<pre><code>## Error: object &#39;irished&#39; not found
</code></pre>

<p>To run these commands, you can copy-paste them to the command window, or you can run the script directly. To do this, save the script from the file menu, giving it the name <code>plotIrish.r</code>. Now the script can be run using the <code>source()</code> command.</p>

<pre><code class="r">source(&quot;plotIrish.r&quot;)
</code></pre>

<p>And R will read through the script, executing each command in turn. Now if there are any mistakes or changes to be made, you can simply edit the script and re-run it.</p>

<h3>Programming flow</h3>

<p>R contains the usual commands to control the flow of a program (<code>if()</code>, <code>for()</code>, <code>while()</code>). You can write a simple for loop as follows:</p>

<pre><code class="r">for (i in 1:10) {
    print(i)
}
</code></pre>

<p>This runs a loop ten times, each time printing out the value of the iterator \texttt{i}. Note the format of the loop: the details of the loop are given in parentheses, and the commands to execute at each iteration are given between the curly brackets.</p>

<p>A slightly more complex example is given in the script \emph{cointoss.r}.</p>

<pre><code class="r">source(&quot;cointoss.r&quot;)
</code></pre>

<p>This uses a for loop to simulate 100 coin tosses. In each iteration, a random number (between 0 and 1) is created, if this is over 0.5, this is taken to be &#39;heads&#39; and a counter is increased by 1. Finally, the script prints out the number of &#39;heads&#39; and the number of tails. The script uses a number of new functions: <code>runif()</code>, which selects a number from a uniform random distribution between 0 and 1, and <code>paste()</code> which pastes together character strings and variables for screen output.</p>

<p>Try to extend the script by increasing the number of loops, and by calculating the proportion of heads from the total number of loops at the end. </p>

<h3>Creating your own functions</h3>

<p>Once you have some experience with R, it is fairly easy to create your own functions. This is particularly useful if you need to repeat a set of analyses several times. The following code creates a function to calculate the standard deviation. </p>

<pre><code class="r">mySD &lt;- function(x) {
    sqrt(var(x))
}
</code></pre>

<p>Once created, this exists as an object in the R workspace. Type \texttt{ls()} to see this. It can now be used in the same way as other functions</p>

<pre><code class="r">mySD(bet)  # compare to sd(sl)
sd(bet)
</code></pre>

</body>

</html>

